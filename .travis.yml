sudo: true
language: cpp
os:
  - linux

compiler:
  - gcc

env:
  matrix:
    - ACE=1
  global:
    - CURPATH=$(pwd)
    - ACEDIR=$HOME/Tools
    - ACE_ROOT=$ACEDIR/ACE
    - LD_LIBRARY_PATH=$ACE_ROOT/lib:$LD_LIBRARY_PATH
    - COMPILER=g++-7

before_install:
  - mkdir -p $ACEDIR
  - cd $ACEDIR
  - git clone --depth 1 git://github.com/DOCGroup/MPC.git

branches:
  only:
    - master

before_script:
  - export
  - echo -e "#include \"ace/config-linux.h\"" > $ACE_ROOT/ace/config.h;
  - echo -e "#define ACE_HAS_EVENT_POLL" >> $ACE_ROOT/ace/config.h;
  - echo -e "include \$(ACE_ROOT)/include/makeinclude/platform_linux.GNU" > $ACE_ROOT/include/makeinclude/platform_macros.GNU;
  - cd $ACE_ROOT
  - perl $ACE_ROOT/bin/mwc.pl -type gnuace -workers 2 ace.mwc
  - make -j 6

  - ls $ACE_ROOT/lib
script:
  - echo -e "hello world!"
  - echo -e $ACE_ROOT
  - echo -e $CURPATH